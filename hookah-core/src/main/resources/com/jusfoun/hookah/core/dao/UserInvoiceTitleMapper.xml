<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jusfoun.hookah.core.dao.UserInvoiceTitleMapper" >

    <resultMap id="UserInvoiceTitleVoResultMap" type="com.jusfoun.hookah.core.domain.vo.UserInvoiceTitleVo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="title_id" property="titleId" jdbcType="VARCHAR" />
        <result column="user_invoice_type" property="userInvoiceType" jdbcType="TINYINT" />
        <result column="user_id" property="userId" jdbcType="VARCHAR" />
        <result column="title_name" property="titleName" jdbcType="VARCHAR" />
        <result column="taxpayer_identify_no" property="taxpayerIdentifyNo" jdbcType="VARCHAR" />
        <result column="reg_address" property="regAddress" jdbcType="VARCHAR" />
        <result column="reg_tel" property="regTel" jdbcType="VARCHAR" />
        <result column="reg_time" property="regTime" jdbcType="TIMESTAMP" />
        <result column="open_bank" property="openBank" jdbcType="VARCHAR" />
        <result column="bank_account" property="bankAccount" jdbcType="VARCHAR" />
        <result column="default_status" property="defaultStatus" jdbcType="TINYINT" />
        <result column="invoice_status" property="invoiceStatus" jdbcType="TINYINT" />
        <result column="add_time" property="addTime" jdbcType="TIMESTAMP" />
        <result column="version" property="version" jdbcType="INTEGER" />

        <result column="user_type" jdbcType="TINYINT" property="userType" />
        <result column="user_name" jdbcType="VARCHAR" property="userName" />
        <result column="real_name" jdbcType="VARCHAR" property="realName" />

    </resultMap>

    <select id="getIncreInvoiceList" resultMap="UserInvoiceTitleVoResultMap">

        SELECT
        ut.*,
        u.user_name,
        u.user_type,
        ud.real_name
        FROM
        user_invoice_title ut,
        user u,
        user_detail ud
        WHERE
        ut.user_id = u.user_id
        AND u.user_id = ud.user_id
        AND ut.user_invoice_type = 1
        <if test="userName != null ">
            AND u.user_name LIKE '%${userName}%'
        </if>
        <if test="userType != -1 ">
            AND user_type = #{userType,jdbcType=TINYINT}
        </if>
        <if test="invoiceStatus != -1 ">
            AND ut.invoice_status = #{invoiceStatus,jdbcType=TINYINT}
        </if>
    </select>

    <select id="findUserInvoiceTitleInfo" resultMap="UserInvoiceTitleVoResultMap">

        SELECT
        ut.*,
        u.user_name,
        u.user_type,
        ud.real_name
        FROM
        user_invoice_title ut,
        user u,
        user_detail ud
        WHERE
        ut.user_id = u.user_id
        AND u.user_id = ud.user_id
        AND ut.user_invoice_type = 1
        AND ut.title_id = #{titleId,jdbcType=VARCHAR}

    </select>
</mapper>